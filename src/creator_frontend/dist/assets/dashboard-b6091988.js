import{r as l,u as F,j as e,R as T,C as s}from"./index-43d0fa9b.js";import{c as i}from"./index-d5840571.js";import{S as _}from"./Spinner-c61f8477.js";import{A as E}from"./Alert-294d6ed2.js";import{R as a,C as c}from"./Row-fefb1cc1.js";import{T as d}from"./Table-ed804b5b.js";import"./CloseButton-102e4345.js";const z=()=>{const[n,g]=l.useState({clientsCount:0,artistsCount:0,artworksCount:0,totalPayments:0,recentClients:[],recentArtists:[],recentPayments:[],adminInfo:null}),[p,o]=l.useState(!0),[h,x]=l.useState(""),C=F();l.useEffect(()=>{(async()=>{try{const r=localStorage.getItem("user"),m=JSON.parse(r);if(!m){x("No logged-in admin found. Please log in."),o(!1);return}const w=(await i.getAdminById(Number(m.id)))[0],j=await i.getClients(),u=await i.getArtists(),b=await i.getArtworks(),f=await i.getAllPayments(),k=j.slice(-3),A=u.slice(-3),v=f.slice(-3),D=j.length,S=u.length,P=b.length,I=f.reduce((B,R)=>B+BigInt(R.amount),BigInt(0));g({clientsCount:D,artistsCount:S,artworksCount:P,totalPayments:I.toString(),recentClients:k,recentArtists:A,recentPayments:v,adminInfo:w||null})}catch(r){console.error("Failed to fetch dashboard data:",r),x("Failed to fetch data.")}finally{o(!1)}})()},[]);const y=t=>{C(t)},N=[{title:"Clients",linkClick:"/admin/view-clients",amount:n.clientsCount,icon:"icon-arrow-up text-c-green"},{title:"Artists",linkClick:"/admin/view-artists",amount:n.artistsCount,icon:"icon-arrow-up text-c-green"},{title:"Total Payments",linkClick:"/admin/view-payments",amount:`${n.totalPayments} Frw`,icon:"icon-arrow-up text-c-green"}];return p?e.jsx(_,{animation:"border",variant:"primary"}):h?e.jsx(E,{variant:"danger",children:h}):e.jsxs(T.Fragment,{children:[n.adminInfo&&e.jsx(a,{className:"mb-4",children:e.jsx(c,{children:e.jsx(s,{children:e.jsxs(s.Body,{children:[e.jsx("h5",{children:"Admin Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",n.adminInfo.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",n.adminInfo.username]})]})})})}),e.jsx(a,{children:N.map((t,r)=>e.jsx(c,{xl:6,xxl:4,children:e.jsx(s,{onClick:()=>y(t.linkClick),children:e.jsxs(s.Body,{children:[e.jsx("h6",{className:"mb-4",children:t.title}),e.jsx("div",{className:"row d-flex align-items-center",children:e.jsx("div",{className:"col-9",children:e.jsxs("h3",{className:"f-w-300 d-flex align-items-center m-b-0",children:[e.jsx("i",{className:`feather ${t.icon} f-30 m-r-5`})," ",t.amount]})})})]})})},r))}),e.jsx(a,{className:"mb-4",children:e.jsx(c,{children:e.jsxs(s,{children:[e.jsx(s.Header,{children:e.jsx(s.Title,{as:"h5",children:"Recent Clients"})}),e.jsx(s.Body,{children:e.jsxs(d,{responsive:!0,hover:!0,striped:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Phone Number"})]})}),e.jsx("tbody",{children:n.recentClients.length>0?n.recentClients.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.username}),e.jsx("td",{children:t.phone_number})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No recent clients found."})})})]})})]})})}),e.jsx(a,{className:"mb-4",children:e.jsx(c,{children:e.jsxs(s,{children:[e.jsx(s.Header,{children:e.jsx(s.Title,{as:"h5",children:"Recent Artists"})}),e.jsx(s.Body,{children:e.jsxs(d,{responsive:!0,hover:!0,striped:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Bio"})]})}),e.jsx("tbody",{children:n.recentArtists.length>0?n.recentArtists.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.bio})]},t.artist_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No recent artists found."})})})]})})]})})}),e.jsx(a,{className:"mb-4",children:e.jsx(c,{children:e.jsxs(s,{children:[e.jsx(s.Header,{children:e.jsx(s.Title,{as:"h5",children:"Recent Payments"})}),e.jsx(s.Body,{children:e.jsxs(d,{responsive:!0,hover:!0,striped:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Artwork ID"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.recentPayments.length>0?n.recentPayments.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsx("td",{children:Number(t.artwork_id)}),e.jsxs("td",{children:[parseFloat(t.amount)," Frw"]}),e.jsx("td",{children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{children:t.payment_status})]},t.payment_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"No recent payments found."})})})]})})]})})})]})};export{z as default};
